<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{layout/base :: head(${employee.id != null} ? '従業員情報更新' : '従業員登録', @{/css/form-style.css})}">
</head>

<body th:replace="~{layout/base :: body(~{::content})}">

<main th:fragment="content">

    <h1 th:text="*{id != null} ? '従業員情報更新' : '新しい従業員を登録'">新しい従業員を登録</h1>

    <form class="data-form"
          th:action="*{id != null} ? @{/web/employees/update/{id}(id=*{id})} : @{/web/employees}"
          th:object="${employee}"
          method="post">

        <input type="hidden" th:field="*{id}" th:if="*{id != null}" />

        <div th:if="${#fields.hasGlobalErrors()}" class="alert alert-danger">
            <p th:each="err : ${#fields.globalErrors()}" th:text="${err}">グローバルエラーメッセージ</p>
        </div>

        <h2 class="form-subheading">基本情報</h2>

        <div class="form-group">
            <label for="lastName">姓<span class="required">*</span>:</label>
            <input type="text" id="lastName" th:field="*{lastName}" class="form-control" />
            <div th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}" class="error-message"></div>
        </div>

        <div class="form-group">
            <label for="firstName">名<span class="required">*</span>:</label>
            <input type="text" id="firstName" th:field="*{firstName}" class="form-control" />
            <div th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}" class="error-message"></div>
        </div>

        <div class="form-group">
            <label for="email">メールアドレス<span class="required">*</span>:</label>
            <input type="email" id="email" th:field="*{email}" class="form-control" />
            <div th:if="${#fields.hasErrors('email')}" th:errors="*{email}" class="error-message"></div>
        </div>

        <h2 class="form-subheading">所属・役職</h2>

        <div class="form-group">
            <label for="departmentId">所属部署<span class="required">*</span>:</label>
            <select id="departmentId" th:field="*{departmentId}" class="form-control">
                <option value="">選択してください</option>
                <option th:each="dept : ${departments}" th:value="${dept.id}" th:text="${dept.name} + ' (' + ${dept.location} + ')'"></option>
            </select>
            <div th:if="${#fields.hasErrors('departmentId')}" th:errors="*{departmentId}" class="error-message"></div>
        </div>

        <div class="form-group">
            <label for="position">役職<span class="required">*</span>:</label>
            <input type="text" id="position" th:field="*{position}" class="form-control" />
            <div th:if="${#fields.hasErrors('position')}" th:errors="*{position}" class="error-message"></div>
        </div>

        <div class="form-group">
            <label th:if="*{id == null}" for="hireDate">入社日<span class="required">*</span>:</label>
            <label th:if="*{id != null}">入社日:</label>

            <input type="date" id="hireDate" th:field="*{hireDate}" class="form-control" required th:if="*{id == null}" />

            <div th:if="*{id != null}" class="form-control-static">
                <span th:text="*{hireDate}">2020-01-01</span>
                <input type="hidden" th:field="*{hireDate}" />
            </div>
            <div th:if="${#fields.hasErrors('hireDate')}" th:errors="*{hireDate}" class="error-message"></div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary" th:text="*{id != null} ? '更新する' : '登録する'">登録する</button>
            <a th:href="@{/web/employees}" class="btn btn-link">一覧に戻る</a>
        </div>
    </form>

</main>
</body>
</html>